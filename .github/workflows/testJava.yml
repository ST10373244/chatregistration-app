name: Java CI with JUnit Tests

on:
  push:
    branches: [ "main", "master" ]
  pull_request:
    branches: [ "main", "master" ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'temurin'
        
    - name: Download dependencies
      run: |
        wget -O json.jar https://repo1.maven.org/maven2/org/json/json/20231013/json-20231013.jar
        wget -O junit.jar https://repo1.maven.org/maven2/junit/junit/4.13.2/junit-4.13.2.jar
        wget -O hamcrest.jar https://repo1.maven.org/maven2/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar
        
    - name: Compile all Java files
      run: |
        javac -cp ".:json.jar:junit.jar:hamcrest.jar" *.java
        
    - name: Run Login Tests
      run: |
        java -cp ".:json.jar:junit.jar:hamcrest.jar" org.junit.runner.JUnitCore LoginTest
        
    - name: Run Message Tests
      run: |
        java -cp ".:json.jar:junit.jar:hamcrest.jar" org.junit.runner.JUnitCore MessageTest
        
    - name: Run MessageManager Tests
      run: |
        java -cp ".:json.jar:junit.jar:hamcrest.jar" org.junit.runner.JUnitCore MessageManagerTest
        
    - name: All tests passed
      run: echo "âœ… All unit tests completed successfully!"
